import { Injectable } from '@nestjs/common'; import { AuthGuard } from '@nestjs/passport';
@Injectable() export class JwtGuard extends AuthGuard('jwt') { canActivate(context) { return super.canActivate(context); } handleRequest(err, user, info) { if (err || !user) { throw err || new Error('Unauthorized'); } return user; } }